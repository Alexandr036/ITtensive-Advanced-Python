### 01 Работа с PDF - Задание - сборка PDF документа
#### Задача

Используя данные по посещаемости библиотек в районах Москвы
https://video.ittensive.com/python-advanced/data-7361-2019-11-28.utf.json
постройте круговую диаграмму суммарной посещаемости (NumOfVisitors) 20 наиболее популярных районов Москвы.
Создайте PDF отчет, используя файл
https://video.ittensive.com/python-advanced/title.pdf
как первую страницу. На второй странице выведите итоговую диаграмму, самый популярный район Москвы и число посетителей библиотек в нем.
__Метод решения:__
1. Подключим библиотеки pandas, json, requests, matplotlib, reportlab, PyPDF2, PIL.
2. Загрузим данные в датафрейм из полученного get запроса, через json.loads, пустые значения заполним нулями, посмотрим на данные.
3. Обнаружив, что данные по району находятся в виде json который разобран в словарь, для его извлечения понадобится вспомогательная функция (честно подсмотрел как извлечь район).
4. Извлекли район, по нему сгруппировали, просуммировав посетителей и отсортировав по убыванию.
5. Построили диаграмму по срезу из 20 библиотек, легенду вывели справа от диаграммы и сохранили изображение.
6. Создадим страницу отчета с данным по библиотекам, для начала регистрируем шрифт и выставляем размер холста А4.
7. Добавляем заголовок и данные по самому популярному району и количеству посетителей библиотек в нем.
8. Добавляем наш график через ImageReader и сохраняем PDF файл. 
9. Объединим титульный лист и лист отчета в один файл, добавим мета данные и запишем готовый отчет.
___
### 02 Базовые отчеты - Задание - геральдические символы Москвы
#### Задача

Сгенерируйте PDF документ из списка флагов и гербов районов Москвы: https://video.ittensive.com/python-advanced/data-102743-2019-11-13.utf.csv
На каждой странице документа выведите название геральдического символа (Name), его описание (Description) и его изображение (Picture).
Для показа изображений используйте адрес https://op.mos.ru/MEDIA/showFile?id=XXX
где XXX - это значение поля Picture в наборе данных. 
В случае возникновения проблем с загрузкой изображений с op.mos.ru можно добавить в код настройку для форсирования использования дополнительных видов шифрования в протоколе SSL/TLS.
requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS = 'ALL:@SECLEVEL=1'
__Метод решения:__
1. Подключим библиотеки pandas, requests, pdfkit.
2. Сразу сконфигурируем pdfkit и загрузим данные в дата фрейм.
3. Сформируем HTML код (станицу) для создания отчета, в котором через for переберем все строки из фрейма и получим все необходимые страницы отчета, так как туда будут подставляться изображение символа, его название и описание.
4. Введем условие, что если это первая станица, то выводим обычный стиль заголовка, если нет то выводим style="page-break-before:always", что делает разрыв раздела с каждой новой страницы, чтобы каждый знак был на отдельной странице.
5. Прописываем опции для pdfkit, размер страницы и нумерацию.
6. Из HTML кода при помощи pdfkit собираем PDF документ отчета. 
___
### 03 Генерация отчетов - Задание - многостраничный отчет
#### Задача
Используя данные по активностям в парках Москвы https://video.ittensive.com/python-advanced/data-107235-2019-12-02.utf.json
Создайте PDF отчет, в котором выведите:
1. Диаграмму распределения числа активностей по паркам, топ10 самых активных
2. Таблицу активностей по всем паркам в виде Активность-Расписание-Парк

__Метод решения:__
1. Подключим библиотеки pandas, requests, pdfkit, matplotlib, binascii, jinja2.
2. Загрузим данные из get запроса в через json.loads и выберем всего 3 колонки данных которые нам понадобятся. 
3. Взглянув на данные, увидим что название парка находится в словаре, через лямбда функцию извлечём название парка по ключу "value".
4. Создадим новый фрейм данных top10 из сгруппированных по парку, посчитанного количества активностей и отсортированных в порядке убывания десяти первых значений фрейма data.
5. Построим диаграмму из top10 и сохраним изображение диаграммы.
6. Для дальнейшего построения таблицы активности, переименуем колонки.
7. Откроем ранее сохраненное изображение и через binascii преобразуем его в формат дата ури.
8. Напишем HTML шаблон html_template, в необходимых местах через {{data.xxx}} вставим код, который в дальнейшем замениться на нужные значения, которые укажем в render(data={}) при формировании html.
9. Сконфигурируем pdfkit и создадим из HTML наш PDF отчет.
___
### 04 Отправка email и интеграция - Задание - автоматические отчеты
#### Задача
Соберите отчет по результатам ЕГЭ в 2018-2019 году, используя данные https://video.ittensive.com/python-advanced/data-9722-2019-10-14.utf.csv и отправьте его в HTML формате по адресу support@ittensive.com, используя только Python.
В отчете должно быть:
1. общее число отличников (учеников, получивших более 220 баллов по ЕГЭ в Москве),
2. распределение отличников по округам Москвы,
3. название школы с лучшими результатами по ЕГЭ в Москве. 
Диаграмма распределения должна быть вставлена в HTML через data:URI формат (в base64-кодировке).
Дополнительно: приложите к отчету PDF документ того же содержания (дублирующий письмо).

__Метод решения:__
1. Подключим библиотеки pandas, io, pdfkit, matplotlib, binascii, jinja2.
2. Загрузим данные из csv файла, преобразуем названия округов, установим год как индекс, сделаем срез по 2018-2019 году. 
3. Сгруппируем данные по округам, просуммируем количество отличников и отсортируем по убыванию.
4. Отрисуем круговую диаграмму нашим данным и через autopct нанесем количество отличников по округам.
5. При помощи BytesIO(), сохраним наше изображение img как объект BytesIO() и через binascii преобразуем его в формат дата ури. 
6. Подготовим данные общее количество отличников и название школы с наибольшим количеством отличников, чтобы потом вставить их в отчет.
7. Напишем HTML шаблон html_template, в необходимых местах через {{data.xxx}} вставим код, который в дальнейшем замениться на нужные значения, которые укажем в render(data={}) при формировании html.
8. Cконфигурируем pdfkit и создадим из HTML наш PDF отчет, а также сохраним и саму html файл отчета, чтобы в дальнейшем использовать ее при формировании письма.
9. Сформируем письмо, с помощью MIMEMultipart зададим все заголовки, добавим содержание к телу письма через MIMEText (наш html файл отчета).
10. С помощью MIMEBase добавим к письму вложение (PDF файл отчета), преобразуем бинарные файлы в base64 формат с помощью encoders и прикрепим к письму.
11. Укажем user и password, а также настройки почтового сервера, в sendmail указываем отправителя и получателя, а также as_string у объекта MINEMultipart.
12. Закрываем соединение с почтовым сервером. 
___